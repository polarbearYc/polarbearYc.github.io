<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI化学工具箱 - 交互界面</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- 原有样式保持不变 -->
    <style>
        /* 原有样式保持不变 */
    </style>
</head>
<body>
    <!-- 顶部导航栏保持不变 -->
    <header class="app-header">
        <!-- 原有顶部导航栏内容 -->
    </header>

    <div class="app-container">
        <!-- 左侧导航保持不变 -->
        <aside class="sidebar">
            <!-- 原有侧边栏内容 -->
        </aside>

        <!-- 主工作区 -->
        <main class="workspace">
            <!-- 工具箱区域 - 添加新工具 -->
            <div class="toolbox-section" id="toolbox-section">
                <div class="section-title">
                    <i class="fas fa-toolbox"></i>
                    <span>化学工具箱</span>
                </div>
                
                <div class="toolbox-grid">
                    <!-- 原有工具箱项目保持不变 -->
                    <!-- 添加新的有机分子数据采集与分析工具 -->
                    <div class="toolbox-item" data-tool="molecule-analysis">
                        <div class="toolbox-icon">
                            <i class="fas fa-database"></i>
                        </div>
                        <div class="toolbox-name">分子数据分析</div>
                        <div class="toolbox-desc">有机分子数据采集与物理化学性质分析</div>
                    </div>
                    
                    <!-- 其他原有工具箱项目 -->
                </div>
            </div>
            
            <!-- 案例库区域保持不变 -->
            <div class="case-library" id="case-library">
                <!-- 原有案例库内容 -->
            </div>
            
            <!-- AI聊天框保持不变 -->
            <div class="ai-chatbox" id="ai-chatbox">
                <!-- 原有聊天框内容 -->
            </div>
        </main>
    </div>
    
    <!-- 模态框 - 添加新工具的内容 -->
    <div class="modal" id="tool-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div class="modal-title" id="modal-title">工具详情</div>
            <div id="modal-content">
                <!-- 动态内容将在这里显示 -->
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 原有案例数据保持不变
        
        // 渲染案例卡片函数保持不变
        
        // 筛选功能保持不变

        document.addEventListener('DOMContentLoaded', function() {
            // 原有初始化代码保持不变
            
            // 在工具箱项目点击事件中添加新工具的处理
            const toolboxItems = document.querySelectorAll('.toolbox-item');
            toolboxItems.forEach(item => {
                item.addEventListener('click', function() {
                    const tool = this.getAttribute('data-tool');
                    openToolModal(tool);
                });
            });
            
            // 在openToolModal函数中添加新工具的内容
            function openToolModal(tool) {
                const modal = document.getElementById('tool-modal');
                const modalTitle = document.getElementById('modal-title');
                const modalContent = document.getElementById('modal-content');
                
                // 根据工具类型设置内容和标题
                switch(tool) {
                    // 原有工具case保持不变
                    
                    case 'molecule-analysis':
                        modalTitle.textContent = '有机分子数据采集与分析';
                        modalContent.innerHTML = `
                            <h3>有机分子数据采集与物理化学性质分析</h3>
                            <p>此工具可以从PubChem/ChEMBL下载分子数据，并计算分子量、LogP、极化率等物理化学性质。</p>
                            
                            <div class="row mt-4">
                                <div class="col-md-6">
                                    <div class="card mb-4">
                                        <div class="card-header bg-primary text-white">
                                            <i class="fas fa-cloud-download-alt"></i> 数据采集
                                        </div>
                                        <div class="card-body">
                                            <div class="form-group mb-3">
                                                <label for="molecule-source">数据源：</label>
                                                <select id="molecule-source" class="form-select">
                                                    <option value="pubchem">PubChem</option>
                                                    <option value="chembl">ChEMBL</option>
                                                    <option value="custom">自定义SMILES</option>
                                                </select>
                                            </div>
                                            <div class="form-group mb-3" id="pubchem-input">
                                                <label for="pubchem-id">PubChem CID：</label>
                                                <input type="text" id="pubchem-id" class="form-control" placeholder="例如：241 (苯)">
                                            </div>
                                            <div class="form-group mb-3 d-none" id="chembl-input">
                                                <label for="chembl-id">ChEMBL ID：</label>
                                                <input type="text" id="chembl-id" class="form-control" placeholder="例如：CHEMBL15983 (环己烷)">
                                            </div>
                                            <div class="form-group mb-3 d-none" id="smiles-input">
                                                <label for="smiles-code">SMILES代码：</label>
                                                <input type="text" id="smiles-code" class="form-control" placeholder="例如：c1ccccc1 (苯)">
                                            </div>
                                            <button id="fetch-data" class="btn btn-primary w-100">
                                                <i class="fas fa-download"></i> 获取分子数据
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header bg-success text-white">
                                            <i class="fas fa-chart-bar"></i> 分析选项
                                        </div>
                                        <div class="card-body">
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="calc-mw" checked>
                                                <label class="form-check-label" for="calc-mw">分子量</label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="calc-logp" checked>
                                                <label class="form-check-label" for="calc-logp">脂水分配系数(LogP)</label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="calc-polar" checked>
                                                <label class="form-check-label" for="calc-polar">极化率</label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="calc-hbd">
                                                <label class="form-check-label" for="calc-hbd">氢键供体数</label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="calc-hba">
                                                <label class="form-check-label" for="calc-hba">氢键受体数</label>
                                            </div>
                                            <button id="analyze-btn" class="btn btn-success w-100 mt-3" disabled>
                                                <i class="fas fa-calculator"></i> 分析分子性质
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card mt-4">
                                <div class="card-header bg-info text-white">
                                    <i class="fas fa-table"></i> 分析结果
                                </div>
                                <div class="card-body">
                                    <div id="results-container" style="min-height: 200px;">
                                        <p class="text-muted">请先获取并分析分子数据...</p>
                                    </div>
                                    <div class="mt-3 d-flex justify-content-between">
                                        <button id="export-excel" class="btn btn-outline-primary" disabled>
                                            <i class="fas fa-file-excel"></i> 导出Excel
                                        </button>
                                        <button id="visualize-btn" class="btn btn-outline-primary" disabled>
                                            <i class="fas fa-chart-line"></i> 可视化结果
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-4" id="visualization-area" style="display: none;">
                                <h4>可视化图表</h4>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="chart-container" style="height: 300px; background-color: #f8f9fa; display: flex; justify-content: center; align-items: center;">
                                            <p class="text-muted">分子量对比图将显示在这里</p>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="chart-container" style="height: 300px; background-color: #f8f9fa; display: flex; justify-content: center; align-items: center;">
                                            <p class="text-muted">LogP对比图将显示在这里</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                        
                        // 添加新工具的事件处理
                        setupMoleculeAnalysisTool();
                        break;
                        
                    // 其他原有工具case保持不变
                }
                
                modal.style.display = 'flex';
            }
            
            // 设置分子分析工具的事件处理
            function setupMoleculeAnalysisTool() {
                // 数据源切换
                document.getElementById('molecule-source').addEventListener('change', function() {
                    document.getElementById('pubchem-input').classList.add('d-none');
                    document.getElementById('chembl-input').classList.add('d-none');
                    document.getElementById('smiles-input').classList.add('d-none');
                    
                    const source = this.value;
                    if (source === 'pubchem') {
                        document.getElementById('pubchem-input').classList.remove('d-none');
                    } else if (source === 'chembl') {
                        document.getElementById('chembl-input').classList.remove('d-none');
                    } else if (source === 'custom') {
                        document.getElementById('smiles-input').classList.remove('d-none');
                    }
                });
                
                // 模拟获取分子数据
                document.getElementById('fetch-data').addEventListener('click', function() {
                    const source = document.getElementById('molecule-source').value;
                    let inputValue, moleculeName;
                    
                    if (source === 'pubchem') {
                        inputValue = document.getElementById('pubchem-id').value.trim();
                        if (!inputValue) {
                            alert('请输入PubChem CID');
                            return;
                        }
                        moleculeName = `PubChem CID: ${inputValue}`;
                    } else if (source === 'chembl') {
                        inputValue = document.getElementById('chembl-id').value.trim();
                        if (!inputValue) {
                            alert('请输入ChEMBL ID');
                            return;
                        }
                        moleculeName = `ChEMBL ID: ${inputValue}`;
                    } else {
                        inputValue = document.getElementById('smiles-code').value.trim();
                        if (!inputValue) {
                            alert('请输入SMILES代码');
                            return;
                        }
                        moleculeName = `SMILES: ${inputValue}`;
                    }
                    
                    // 模拟API调用
                    setTimeout(() => {
                        // 启用分析按钮
                        document.getElementById('analyze-btn').disabled = false;
                        
                        // 显示成功消息
                        const resultsContainer = document.getElementById('results-container');
                        resultsContainer.innerHTML = `
                            <div class="alert alert-success">
                                <i class="fas fa-check-circle"></i> 成功获取分子数据: ${moleculeName}
                                <div class="mt-2">
                                    <strong>SMILES:</strong> ${generateRandomSMILES()}
                                </div>
                            </div>
                        `;
                    }, 1000);
                });
                
                // 模拟分析分子性质
                document.getElementById('analyze-btn').addEventListener('click', function() {
                    const resultsContainer = document.getElementById('results-container');
                    resultsContainer.innerHTML = `
                        <div class="alert alert-info">
                            <i class="fas fa-spinner fa-spin"></i> 正在分析分子性质...
                        </div>
                    `;
                    
                    // 模拟分析过程
                    setTimeout(() => {
                        const properties = generateRandomProperties();
                        
                        // 构建结果表格
                        let tableHtml = `
                            <div class="table-responsive">
                                <table class="table table-bordered">
                                    <thead class="table-light">
                                        <tr>
                                            <th>性质</th>
                                            <th>值</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                        `;
                        
                        for (const [prop, value] of Object.entries(properties)) {
                            tableHtml += `
                                <tr>
                                    <td>${prop}</td>
                                    <td>${value}</td>
                                </tr>
                            `;
                        }
                        
                        tableHtml += `
                                    </tbody>
                                </table>
                            </div>
                        `;
                        
                        resultsContainer.innerHTML = tableHtml;
                        
                        // 启用导出和可视化按钮
                        document.getElementById('export-excel').disabled = false;
                        document.getElementById('visualize-btn').disabled = false;
                    }, 1500);
                });
                
                // 模拟导出Excel
                document.getElementById('export-excel').addEventListener('click', function() {
                    alert('模拟导出Excel文件: 分子性质数据.xlsx');
                });
                
                // 模拟可视化
                document.getElementById('visualize-btn').addEventListener('click', function() {
                    const vizArea = document.getElementById('visualization-area');
                    vizArea.style.display = 'block';
                    
                    // 模拟图表生成
                    const chartContainers = document.querySelectorAll('.chart-container');
                    chartContainers.forEach(container => {
                        container.innerHTML = `
                            <div style="text-align: center;">
                                <i class="fas fa-chart-bar" style="font-size: 48px; color: #6c757d;"></i>
                                <p class="mt-2">${container.textContent.includes('分子量') ? '分子量对比图' : 'LogP对比图'}已生成</p>
                            </div>
                        `;
                    });
                });
            }
            
            // 辅助函数：生成随机SMILES
            function generateRandomSMILES() {
                const smilesList = [
                    'C1=CC=CC=C1', // 苯
                    'CCO', // 乙醇
                    'CC(=O)OC1=CC=CC=C1C(=O)O', // 阿司匹林
                    'CN1C=NC2=C1C(=O)N(C(=O)N2C)C', // 咖啡因
                    'C1CCCCC1' // 环己烷
                ];
                return smilesList[Math.floor(Math.random() * smilesList.length)];
            }
            
            // 辅助函数：生成随机分子性质
            function generateRandomProperties() {
                return {
                    '分子量(g/mol)': (Math.random() * 300 + 50).toFixed(2),
                    '脂水分配系数(LogP)': (Math.random() * 5).toFixed(2),
                    '极化率(Å³)': (Math.random() * 30 + 5).toFixed(2),
                    '氢键供体数': Math.floor(Math.random() * 5),
                    '氢键受体数': Math.floor(Math.random() * 8),
                    '可旋转键数': Math.floor(Math.random() * 10),
                    '摩尔折射率': (Math.random() * 50 + 10).toFixed(2)
                };
            }
            
            // 原有其他函数保持不变
        });
    </script>
</body>
</html>
